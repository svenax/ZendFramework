<!-- EN-Revision: 14844 -->
<sect1 id="zend.service.amazon.ec2.instance">
    <title>Zend_Service_Amazon_Ec2: Instanzen</title>

    <sect2 id="zend.service.amazon.ec2.instance.types">
        <title>Instanz Typen</title>

        <para>
            Amazon EC2 Instanzen werden in zwei Familien gruppiert: Standard und High-CPU. Standard
            Instanzen haben Speicher und CPU Ratio die für die meisten generell gedachten
            Anwendungen passen; High-CPU Instanzen haben proportional mehr CPI Ressourcen als
            Speicher (RAM) und sind gedacht für rechen-intensive Anwendungen. Wenn Instanz-Typen
            ausgewählt werden, kann es gewünscht sein wenig intensive Instanztypen für Web-Server
            Instanzen zu verwenden und intensivere Instanz-Typen für eigene Datenbank-Instanzen.
            Zusätzlich kann es gewünscht sein CPU Instanztypen für CPU-intensive Datenverarbeitungs
            Tasks zu verwenden.
        </para>
        <para>
            Eine der Vorteile von EC2 ist das man pro Stunde der Instanz zahlt, was es bequem und
            kostengünstig macht die Performance der eigenen Anwendung auf verschiedenen
            Instanzfamilien und Typen zu testen. Ein guter Weg um zu erkennen welches die
            passenste Instanzfamilie und der passenste Instanztyp ist, besteht darin Testinstanzen
            zu starten und die Anweundung zu benchmarken.
        </para>

        <note>
            <title>Instanz Typen</title>
            <para>
                Der Instanztyp ist als Konstante im Code definiert. Spalte acht in der Tabelle ist
                der definierte Name der Konstante
            </para>
        </note>
        <table id="zend.service.amazon.ec2.instance.types-table">
            <title>Vorhandene Instanztypen</title>
            <tgroup cols="8">
                <thead>
                    <row>
                        <entry>Typ</entry>
                        <entry>CPU</entry>
                        <entry>Hauptspeicher</entry>
                        <entry>Plattenspeicher</entry>
                        <entry>Plattform</entry>
                        <entry>I/O</entry>
                        <entry>Name</entry>
                        <entry>Name der Konstante</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry><code>Klein</code></entry>
                        <entry><para>
                            1 EC2 Recheneinheit (1 virtueller Kern mit 1 EC2 Recheneinheit)
                        </para></entry>
                        <entry><para>
                            1.7 GB
                        </para></entry>
                        <entry><para>
                            160 GB Speicher der Instanz (150 GB plus 10 GB Root Partition)
                        </para></entry>
                        <entry><para>
                            32-bit
                        </para></entry>
                        <entry><para>
                            Moderat
                        </para></entry>
                        <entry><para>
                            m1.small
                        </para></entry>
                        <entry><code>Zend_Service_Amazon_Ec2_Instance::SMALL</code></entry>
                    </row>
                    <row>
                        <entry><code>Groß</code></entry>
                        <entry><para>
                            4 EC2 Recheneinheiten (2 virtuelle Kerne mit jeweils 2 EC2
                            Recheneinheiten)
                        </para></entry>
                        <entry><para>
                            7.5 GB
                        </para></entry>
                        <entry><para>
                            850 GB Speicher der Instanz (2 x 420 GB plus 10 GB Root Partition)
                        </para></entry>
                        <entry><para>
                            64-bit
                        </para></entry>
                        <entry><para>
                            Hoch
                        </para></entry>
                        <entry><para>
                            m1.large
                        </para></entry>
                        <entry><code>Zend_Service_Amazon_Ec2_Instance::LARGE</code></entry>
                    </row>
                    <row>
                        <entry><code>Extra Groß</code></entry>
                        <entry><para>
                            8 EC2 Recheneinheiten (4 virtuelle Kerne mit jeweils 2 EC2
                            Recheneinheiten)
                        </para></entry>
                        <entry><para>
                            15 GB
                        </para></entry>
                        <entry><para>
                            1,690 GB Speicher der Instanz (4 x 420 GB plus 10 GB Root Partition)
                        </para></entry>
                        <entry><para>
                            64-bit
                        </para></entry>
                        <entry><para>
                            Hoch
                        </para></entry>
                        <entry><para>
                            m1.xlarge
                        </para></entry>
                        <entry><code>Zend_Service_Amazon_Ec2_Instance::XLARGE</code></entry>
                    </row>
                    <row>
                        <entry><code>High-CPU Medium</code></entry>
                        <entry><para>
                            5 EC2 Recheneinheiten (2 virtuelle Kerne mit jeweils 2.5 EC2
                            Recheneinheiten)
                        </para></entry>
                        <entry><para>
                            1.7 GB
                        </para></entry>
                        <entry><para>
                            350 GB Speicher der Instanz (340 GB plus 10 GB Root Partition)
                        </para></entry>
                        <entry><para>
                            32-bit
                        </para></entry>
                        <entry><para>
                            Durchschnittlich
                        </para></entry>
                        <entry><para>
                            c1.medium
                        </para></entry>
                        <entry><code>Zend_Service_Amazon_Ec2_Instance::HCPU_MEDIUM</code></entry>
                    </row>
                    <row>
                        <entry><code>High-CPU Extra Groß</code></entry>
                        <entry><para>
                            20 EC2 Recheneinheiten (8 virtuelle Kerne mit jeweils 2.5 EC2
                            Recheneinheiten)
                        </para></entry>
                        <entry><para>
                            7 GB
                        </para></entry>
                        <entry><para>
                            1,690 GB Speicher der Instanz (4 x 420 GB plus 10 GB Root Partition)
                        </para></entry>
                        <entry><para>
                            64-bit
                        </para></entry>
                        <entry><para>
                            Hoch
                        </para></entry>
                        <entry><para>
                            c1.xlarge
                        </para></entry>
                        <entry><code>Zend_Service_Amazon_Ec2_Instance::HCPU_XLARGE</code></entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </sect2>

    <sect2 id="zend.service.amazon.ec2.instance.operations">
        <title>Ausführen von Amazon EC2 Instanzen</title>
        <para>
            This section describes the operation methods maintaing Amazon EC2 Instances.
        </para>

        <example id="zend.service.amazon.ec2.instance.operations.run">
            <title>Starting New Ec2 Instances</title>
            <para>
                <code>run</code> will launch a specified number of EC2 Instances.
                <code>run</code> takes an array of parameters to start, below is a table
                containing the valid values.
            </para>
            <para>
            <table id="zend.service.amazon.ec2.instance.operations.run-table">
                <title>Valid Run Options</title>
                <tgroup cols="3">
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Description</entry>
                            <entry>Required</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry><code>imageId</code></entry>
                            <entry><para>
                                ID of the AMI with which to launch instances.
                            </para></entry>
                            <entry><para>Yes</para></entry>
                        </row>
                        <row>
                            <entry><code>minCount</code></entry>
                            <entry><para>
                                Minimum number of instances to launch.  Default: 1
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>maxCount</code></entry>
                            <entry><para>
                                Maximum number of instances to launch.  Default: 1
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>keyName</code></entry>
                            <entry><para>
                                Name of the key pair with which to launch instances.
                                If you do not provide a key, access to the instance will
                                leave it inaccessible.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>securityGroup</code></entry>
                            <entry><para>
                                Names of the security groups with which to associate
                                the instances.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>userData</code></entry>
                            <entry><para>
                                The user data available to the launched instances.
                                This should not be Base64 encoded.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>instanceType</code></entry>
                            <entry><para>
                                Specifies the instance type.  Default: m1.small
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>placement</code></entry>
                            <entry><para>
                                Specifies the availability zone in which to
                                launch the instance(s). By default, Amazon
                                EC2 selects an availability zone for you.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>kernelId</code></entry>
                            <entry><para>
                                The ID of the kernel with which to launch
                                the instance.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>ramdiskId</code></entry>
                            <entry><para>
                                The ID of the RAM disk with which to launch
                                the instance.
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>blockDeviceVirtualName</code></entry>
                            <entry><para>
                                Specifies the virtual name to map to the
                                corresponding device name. For example:
                                instancestore0
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                        <row>
                            <entry><code>blockDeviceName</code></entry>
                            <entry><para>
                                 Specifies the device to which you are
                                 mapping a virtual name. For example: sdb
                            </para></entry>
                            <entry><para>No</para></entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            </para>
            <para>
                <code>run</code> will return information about each instance
                that is starting up.
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->run(array('imageId' => 'ami-509320',
                                   'keyName' => 'myKey',
                                   'securityGroup' => array('web',
                                                            'default')));
]]>
            </programlisting>

        </example>

        <example id="zend.service.amazon.ec2.instance.operations.reboot">
            <title>Rebooting an Ec2 Instances</title>
            <para>
                <code>reboot</code> will reboot one or more instances.
            </para>
            <para>
                This operation is asynchronous; it only queues a request to
                reboot the specified instance(s). The operation will succeed
                if the instances are valid and belong to the user. Requests
                to reboot terminated instances are ignored.
            </para>
            <para>
                <code>reboot</code> returns boolean true or false
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->reboot('instanceId');
]]>
            </programlisting>

        </example>

        <example id="zend.service.amazon.ec2.instance.operations.terminate">
            <title>Terminating an Ec2 Instances</title>
            <para>
                <code>terminate</code> shuts down one or more instances. This
                operation is idempotent; if you terminate an instance more
                than once, each call will succeed.
            </para>
            <para>
                <code>terminate</code> returns boolean true or false
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->terminate('instanceId');
]]>
            </programlisting>
        </example>
        <note>
            <title>Terminated Instances</title>
            <para>Terminated instances will remain visible after termination
            (approximately one hour).</para>
        </note>
    </sect2>

    <sect2 id="zend.service.amazon.ec2.instance.utility">
        <title>Amazon Instance Utilities</title>
        <para>
            In this section you will find out how to retreive information, the console
            output and see if an instance contains a product code.
        </para>

        <example id="zend.service.amazon.ec2.instance.utility.describe">
            <title>Describing an Instance</title>
            <para>
                <code>describe</code> returns information about instances that you own.
            </para>
            <para>
                If you specify one or more instance IDs, Amazon EC2 returns information
                for those instances. If you do not specify instance IDs, Amazon EC2
                returns information for all relevant instances. If you specify an invalid
                instance ID, a fault is returned. If you specify an instance that you do
                not own, it will not be included in the returned results.
            </para>
            <para>
                <code>describe</code> will return an array containing information on the
                instance.
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->describe('instanceId');
]]>
            </programlisting>

        </example>
        <note>
            <title>Terminated Instances</title>
            <para>Recently terminated instances might appear in the returned results.
            This interval is usually less than one hour.</para>
        </note>

        <example id="zend.service.amazon.ec2.instance.utility.consoleOutput">
            <title>Retreiving Console Output</title>
            <para>
                <code>consoleOutput</code> retrieves console output for the specified
                instance.
            </para>
            <para>
                Instance console output is buffered and posted shortly after instance
                boot, reboot, and termination. Amazon EC2 preserves the most recent
                64 KB output which will be available for at least one hour after the
                most recent post.
            </para>
            <para>
                <code>consoleOutput</code> returns an array containing the
                <code>instanceId</code>, <code>timestamp</code> from the last output
                and the <code>output</code> from the console.
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->consoleOutput('instanceId');
]]>
            </programlisting>

        </example>

        <example id="zend.service.amazon.ec2.instance.utility.confirmproduct">
            <title>Confirm Product Code on an Instance</title>
            <para>
                <code>confirmProduct</code> returns true if the specified product code
                is attached to the specified instance. The operation returns false if
                the product code is not attached to the instance.
            </para>
            <para>
                The <code>confirmProduct</code> operation can only be executed by the
                owner of the AMI. This feature is useful when an AMI owner is providing
                support and wants to verify whether a user's instance is eligible.
            </para>
            <programlisting role="php"><![CDATA[
$ec2_instance = new Zend_Service_Amazon_Ec2_Instance('aws_key',
                                                     'aws_secret_key');
$return = $ec2_instance->terminate('productCode', 'instanceId');
]]>
            </programlisting>

        </example>
    </sect2>
</sect1>